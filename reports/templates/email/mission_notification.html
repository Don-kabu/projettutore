{% extends "email/base.html" %}

{% block title %}Nouvelle Mission - Regideso{% endblock %}

{% block header_title %}Nouvelle Mission ğŸ”§{% endblock %}
{% block header_subtitle %}Une intervention a Ã©tÃ© programmÃ©e pour votre signalement{% endblock %}

{% block content %}
    <h2>Bonjour {{ fuite.complaint_name|default:"Citoyen" }},</h2>
    
    <p>Bonne nouvelle ! Nous avons programmÃ© une mission d'intervention pour traiter la fuite d'eau que vous avez signalÃ©e.</p>
    
    <div class="alert alert-success">
        <strong>Mission planifiÃ©e</strong><br>
        Nos techniciens vont intervenir prochainement sur le site de la fuite.
    </div>
    
    <!-- Informations de la mission -->
    <div class="info-card">
        <h3>ğŸ› ï¸ DÃ©tails de la mission</h3>
        
        <div class="info-row">
            <span class="info-label">ğŸ†” NumÃ©ro mission</span>
            <span class="info-value"><strong>#{{ mission.id|stringformat:"05d" }}</strong></span>
        </div>
        
        <div class="info-row">
            <span class="info-label">ğŸ“‹ Signalement associÃ©</span>
            <span class="info-value"><strong>#{{ fuite.id|stringformat:"05d" }}</strong></span>
        </div>
        
        <div class="info-row">
            <span class="info-label">ğŸ“… Date de planification</span>
            <span class="info-value">{{ mission.date_creation|date:"d/m/Y Ã  H:i" }}</span>
        </div>

        <div class="info-row">
            <span class="info-label">photo</span>
            <span class="info-value">{{ mission.photo }}</span>
        </div>
        
        {% if mission.date_prevue %}
        <div class="info-row">
            <span class="info-label">â° Date d'intervention prÃ©vue</span>
            <span class="info-value"><strong>{{ mission.date_prevue|date:"d/m/Y" }}</strong></span>
        </div>
        {% endif %}
        
        <div class="info-row">
            <span class="info-label">ğŸ“ Lieu d'intervention</span>
            <span class="info-value">
                {{ fuite.quartier|default:"Non spÃ©cifiÃ©" }}, 
                {{ fuite.commune|default:"Non spÃ©cifiÃ©e" }}
            </span>
        </div>
        
        {% if fuite.adresse %}
        <div class="info-row">
            <span class="info-label">ğŸ  Adresse exacte</span>
            <span class="info-value">{{ fuite.adresse }}</span>
        </div>
        {% endif %}
        
        <div class="info-row">
            <span class="info-label">âš ï¸ Type d'intervention</span>
            <span class="info-value">
                {% if fuite.gravite == 'critique' %}
                    <span style="color: #dc2626; font-weight: 600;">ğŸš¨ Intervention urgente</span>
                {% elif fuite.gravite == 'moyenne' %}
                    <span style="color: #f59e0b; font-weight: 600;">âš¡ Intervention prioritaire</span>
                {% else %}
                    <span style="color: #10b981; font-weight: 600;">ğŸ”§ Intervention programmÃ©e</span>
                {% endif %}
            </span>
        </div>
        
        {% if mission.description %}
        <div class="info-row">
            <span class="info-label">ğŸ“ DÃ©tails mission</span>
            <span class="info-value">{{ mission.description|truncatewords:25 }}</span>
        </div>
        {% endif %}
    </div>
    
    <!-- Informations de contact Ã©quipe -->
    {% if mission.resolver_phone or mission.resolver_email %}
    <div class="info-card" style="background: linear-gradient(135deg, #f0fdf4, #dcfce7);">
        <h3>Ã‰quipe d'intervention</h3>
        
        {% if mission.resolver_phone %}
        <div class="info-row">
            <span class="info-label">ğŸ“ Contact Ã©quipe</span>
            <span class="info-value"><strong>{{ mission.resolver_phone }}</strong></span>
        </div>
        {% endif %}
        
        {% if mission.resolver_email %}
        <div class="info-row">
            <span class="info-label">Email Ã©quipe</span>
            <span class="info-value">{{ mission.resolver_email }}</span>
        </div>
        {% endif %}
        
        <p style="margin-top: 16px; margin-bottom: 0; color: #065f46; font-size: 14px;">
            ğŸ’¡ <strong>Conseil :</strong> L'Ã©quipe vous contactera directement si besoin d'informations complÃ©mentaires.
        </p>
    </div>
    {% endif %}


    <!-- Que faire en cas de problÃ¨me -->
    <div class="alert alert-warning">
        <strong>ProblÃ¨me le jour J ?</strong><br>
        Si l'Ã©quipe ne se prÃ©sente pas Ã  la date prÃ©vue ou en cas d'urgence, contactez-nous immÃ©diatement au <strong>+243 XXX XXX XXX</strong>
    </div>
    
    <!-- Boutons d'action -->
    <div style="text-align: center; margin: 30px 0;">
        {% if mission.resolver_phone %}
        <a href="tel:{{ mission.resolver_phone }}" class="btn">
            ğŸ“± Contacter l'Ã©quipe d'intervention
        </a>
        <br><br>
        {% endif %}
        <a href="http://127.0.0.1:8000/suivi/{{ fuite.opt }}/" class="btn btn-secondary">
            ğŸ” Suivre l'avancement de la mission
        </a>
    </div>
{% endblock %}