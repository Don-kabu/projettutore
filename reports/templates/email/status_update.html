{% extends "email/base.html" %}

{% block title %}Mise Ã  jour de votre signalement - Regideso{% endblock %}

{% block header_title %}Mise Ã  jour ğŸ“Š{% endblock %}
{% block header_subtitle %}Nouvelles informations sur votre signalement{% endblock %}

{% block content %}
    <h2>Bonjour {{ fuite.complaint_name|default:"Citoyen" }},</h2>
    
    <p>Nous souhaitons vous tenir informÃ©(e) de l'Ã©volution de votre signalement de fuite d'eau.</p>
    
    <!-- Statut principal -->
    <div class="otp-container" style="background: linear-gradient(135deg, #f0fdf4, #dcfce7); border-color: #10b981;">
        <div class="otp-label" style="color: #065f46;">Statut actuel</div>
        <div style="font-size: 24px; font-weight: 700; color: #059669; margin: 12px 0;">
            {% if status == 'verified' %}
                âœ… VÃ‰RIFIÃ‰
            {% elif status == 'in_progress' %}
                ğŸ”„ EN COURS
            {% elif status == 'resolved' %}
                âœ… RÃ‰SOLU
            {% elif status == 'closed' %}
                ğŸ“‹ CLÃ”TURÃ‰
            {% else %}
                ğŸ“ {{ status|upper }}
            {% endif %}
        </div>
        <div style="color: #065f46; font-size: 14px;">
            Signalement #{{ fuite.id|stringformat:"05d" }}
        </div>
    </div>
    
    <!-- DÃ©tails du signalement -->
    <div class="info-card">
        <h3>ğŸ” Informations du signalement</h3>
        
        <div class="info-row">
            <span class="info-label">ğŸ“‹ NumÃ©ro</span>
            <span class="info-value"><strong>#{{ fuite.id|stringformat:"05d" }}</strong></span>
        </div>
        
        <div class="info-row">
            <span class="info-label">ğŸ“… Date signalement</span>
            <span class="info-value">{{ fuite.date_creation|date:"d/m/Y Ã  H:i" }}</span>
        </div>
        
        <div class="info-row">
            <span class="info-label">ğŸ“ Lieu</span>
            <span class="info-value">
                {{ fuite.quartier|default:"Non spÃ©cifiÃ©" }}, 
                {{ fuite.commune|default:"Non spÃ©cifiÃ©e" }}
            </span>
        </div>
        
        <div class="info-row">
            <span class="info-label">âš¡ GravitÃ©</span>
            <span class="info-value">
                {% if fuite.gravite == 'critique' %}
                    <span style="color: #dc2626; font-weight: 600;">ğŸš¨ Critique</span>
                {% elif fuite.gravite == 'moyenne' %}
                    <span style="color: #f59e0b; font-weight: 600;">âš ï¸ Moyenne</span>
                {% else %}
                    <span style="color: #10b981; font-weight: 600;">â„¹ï¸ Faible</span>
                {% endif %}
            </span>
        </div>
    </div>
    
    <!-- Progression -->
    <div class="info-card">
        <h3>ğŸ“ˆ Progression du traitement</h3>
        
        <div style="display: flex; justify-content: space-between; margin: 20px 0; flex-wrap: wrap; gap: 10px;">
            <div style="text-align: center; flex: 1; min-width: 120px;">
                <div style="font-size: 24px; margin-bottom: 8px;">âœ…</div>
                <div style="font-size: 12px; color: #10b981; font-weight: 600;">REÃ‡U</div>
                <div style="font-size: 11px; color: #6b7280;">{{ fuite.date_creation|date:"d/m" }}</div>
            </div>
            
            <div style="text-align: center; flex: 1; min-width: 120px;">
                {% if status == 'verified' or status == 'in_progress' or status == 'resolved' or status == 'closed' %}
                    <div style="font-size: 24px; margin-bottom: 8px;">âœ…</div>
                    <div style="font-size: 12px; color: #10b981; font-weight: 600;">VÃ‰RIFIÃ‰</div>
                {% else %}
                    <div style="font-size: 24px; margin-bottom: 8px;">â³</div>
                    <div style="font-size: 12px; color: #f59e0b; font-weight: 600;">VÃ‰RIFICATION</div>
                {% endif %}
                <div style="font-size: 11px; color: #6b7280;">
                    {% if fuite.verified_opt %}{{ fuite.verified_opt|date:"d/m" }}{% endif %}
                </div>
            </div>
            
            <div style="text-align: center; flex: 1; min-width: 120px;">
                {% if status == 'in_progress' or status == 'resolved' or status == 'closed' %}
                    <div style="font-size: 24px; margin-bottom: 8px;">ğŸ”„</div>
                    <div style="font-size: 12px; color: #3b82f6; font-weight: 600;">EN COURS</div>
                {% else %}
                    <div style="font-size: 24px; margin-bottom: 8px;">â¸ï¸</div>
                    <div style="font-size: 12px; color: #6b7280; font-weight: 600;">EN ATTENTE</div>
                {% endif %}
                <div style="font-size: 11px; color: #6b7280;"></div>
            </div>
            
            <div style="text-align: center; flex: 1; min-width: 120px;">
                {% if status == 'resolved' or status == 'closed' %}
                    <div style="font-size: 24px; margin-bottom: 8px;">âœ…</div>
                    <div style="font-size: 12px; color: #10b981; font-weight: 600;">RÃ‰SOLU</div>
                {% else %}
                    <div style="font-size: 24px; margin-bottom: 8px;">â³</div>
                    <div style="font-size: 12px; color: #6b7280; font-weight: 600;">EN ATTENTE</div>
                {% endif %}
                <div style="font-size: 11px; color: #6b7280;"></div>
            </div>
        </div>
    </div>
    
    <!-- Message contextuel selon le statut -->
    {% if status == 'verified' %}
        <div class="alert alert-success">
            <strong>âœ… Signalement vÃ©rifiÃ© !</strong><br>
            Votre signalement a Ã©tÃ© examinÃ© et validÃ© par nos Ã©quipes. Une mission d'intervention va Ãªtre programmÃ©e prochainement.
        </div>
        
        <h3 style="color: #1f2937;">ğŸ”œ Prochaines Ã©tapes</h3>
        <ul style="color: #4b5563; line-height: 1.6;">
            <li>ğŸ“‹ <strong>Planification :</strong> Nos Ã©quipes vont programmer une mission d'intervention</li>
            <li>ğŸ‘·â€â™‚ï¸ <strong>Attribution :</strong> Une Ã©quipe technique sera assignÃ©e</li>
            <li>ğŸ“± <strong>Notification :</strong> Vous recevrez tous les dÃ©tails par email/SMS</li>
            <li>ğŸ”§ <strong>Intervention :</strong> RÃ©solution du problÃ¨me sur site</li>
        </ul>
        
    {% elif status == 'in_progress' %}
        <div class="alert alert-info">
            <strong>ğŸ”„ Intervention en cours !</strong><br>
            Nos Ã©quipes travaillent activement Ã  la rÃ©solution de votre signalement. L'intervention est en cours.
        </div>
        
        <h3 style="color: #1f2937;">ğŸ› ï¸ Intervention active</h3>
        <p>Nos techniciens sont actuellement sur le terrain et travaillent Ã  rÃ©soudre le problÃ¨me de fuite. Merci de votre patience.</p>
        
        <div class="info-card" style="background: linear-gradient(135deg, #f0f9ff, #e0f2fe);">
            <h3>â° DurÃ©e estimÃ©e</h3>
            <p style="margin: 0; color: #1e3a8a;">
                Selon la complexitÃ© du problÃ¨me, l'intervention peut prendre entre quelques heures et quelques jours. Vous serez informÃ©(e) dÃ¨s la rÃ©solution.
            </p>
        </div>
        
    {% elif status == 'resolved' %}
        <div class="alert alert-success">
            <strong>ğŸ‰ ProblÃ¨me rÃ©solu !</strong><br>
            Excellente nouvelle ! Le problÃ¨me de fuite a Ã©tÃ© rÃ©solu avec succÃ¨s par nos Ã©quipes.
        </div>
        
        <h3 style="color: #1f2937;">âœ… Mission accomplie</h3>
        <p>Nos techniciens ont terminÃ© l'intervention et le problÃ¨me de fuite d'eau est maintenant rÃ©solu. Vous devriez constater une amÃ©lioration immÃ©diate.</p>
        
        <div class="info-card" style="background: linear-gradient(135deg, #f0fdf4, #dcfce7);">
            <h3>ğŸ” VÃ©rification recommandÃ©e</h3>
            <p style="margin: 0; color: #065f46;">
                Nous vous recommandons de vÃ©rifier la zone dans les prochains jours. Si vous constatez que le problÃ¨me persiste, n'hÃ©sitez pas Ã  nous recontacter.
            </p>
        </div>
        
        <!-- Ã‰valuation du service -->
        <div style="text-align: center; margin: 30px 0;">
            <a href="#" class="btn">
                â­ Ã‰valuer notre intervention
            </a>
        </div>
        
    {% elif status == 'closed' %}
        <div class="alert alert-info">
            <strong>ğŸ“‹ Dossier clÃ´turÃ©</strong><br>
            Votre signalement a Ã©tÃ© traitÃ© et le dossier est maintenant officiellement clÃ´turÃ©.
        </div>
        
        <h3 style="color: #1f2937;">ğŸ“‹ ClÃ´ture du dossier</h3>
        <p>Le traitement de votre signalement est terminÃ©. Le dossier est archivÃ© dans nos systÃ¨mes pour suivi historique.</p>
        
    {% else %}
        <div class="alert alert-info">
            <strong>ğŸ“Š Mise Ã  jour de statut</strong><br>
            Le statut de votre signalement a Ã©tÃ© mis Ã  jour dans notre systÃ¨me.
        </div>
    {% endif %}
    
    {% if message %}
        <div class="info-card">
            <h3>ğŸ’¬ Message de l'Ã©quipe</h3>
            <p style="margin: 0; color: #1f2937; font-style: italic;">
                "{{ message }}"
            </p>
        </div>
    {% endif %}
    
    <!-- Actions disponibles -->
    <div style="text-align: center; margin: 30px 0;">
        <a href="#" class="btn">
            ğŸ” Voir les dÃ©tails complets
        </a>
        <br><br>
        {% if status != 'closed' %}
        <a href="#" class="btn btn-secondary">
            ğŸ“ Contacter l'Ã©quipe
        </a>
        {% endif %}
    </div>
    
    <!-- Informations de contact -->
    {% if status == 'in_progress' %}
    <div class="alert alert-warning">
        <strong>ğŸ“ Besoin d'informations ?</strong><br>
        Si vous avez des questions sur l'intervention en cours, contactez-nous au <strong>+243 XXX XXX XXX</strong>
    </div>
    {% endif %}
    
    <p style="margin-top: 30px; color: #6b7280; font-style: italic; text-align: center;">
        Merci pour votre signalement et votre patience. Ensemble, nous prÃ©servons nos ressources en eau ! ğŸŒğŸ’§
    </p>
{% endblock %}